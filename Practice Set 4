BEGIN
FOR cur_rec IN (SELECT object_name, object_type
FROM user_objects
WHERE object_type IN
('TABLE',
'VIEW',
'PACKAGE',
'PROCEDURE',
'FUNCTION',
'SEQUENCE'
))
LOOP
BEGIN
IF cur_rec.object_type = 'TABLE'
THEN
EXECUTE IMMEDIATE 'DROP '
|| cur_rec.object_type
|| ' "'
|| cur_rec.object_name
|| '" CASCADE CONSTRAINTS';
ELSE
EXECUTE IMMEDIATE 'DROP '
|| cur_rec.object_type
|| ' "'
|| cur_rec.object_name
|| '"';
END IF;
EXCEPTION
WHEN OTHERS
THEN
DBMS_OUTPUT.put_line ( 'FAILED: DROP '
|| cur_rec.object_type
|| ' "'
|| cur_rec.object_name
|| '"'
);
END;
END LOOP;
END;
/
commit;
drop table College; drop
table Student; drop table
Apply;
create table College(cName varchar2(10) primary key, state varchar2(10),
enrollment int);
create table Student(sID int primary key, sName varchar2(10), GPA real, sizeHS
int);
create table Apply(sID int, cName varchar2(10), major varchar2(20), decision char(1),
primary key(sID, major, cName), constraint sID_fk Foreign key(sID) references Student,
constraint cName_fk Foreign key(cName) references College);
delete from Student;
delete from College;
delete from Apply;
insert into Student values (123, 'Amy', 3.9, 1000);
insert into Student values (234, 'Bob', 3.6, 1500);
insert into Student values (345, 'Craig', 3.5, 500);
insert into Student values (456, 'Doris', 3.9, 1000);
insert into Student values (567, 'Edward', 2.9, 2000);
insert into Student values (678, 'Fay', 3.8, 200);
insert into Student values (789, 'Gary', 3.4, 800);
insert into Student values (987, 'Helen', 3.7, 800);
insert into Student values (876, 'Irene', 3.9, 400);
insert into Student values (765, 'Jay', 2.9, 1500);
insert into Student values (654, 'Amy', 3.9, 1000);
insert into Student values (543, 'Craig', 3.4, 2000);
insert into College values ('Stanford', 'CA', 15000); insert
into College values ('Berkeley', 'CA', 36000); insert into
College values ('MIT', 'MA', 10000); insert into College
values ('Cornell', 'NY', 21000); insert into College values
('Harvard', 'MA', 50040); insert into Apply values (123,
'Stanford', 'CS', 'Y'); insert into Apply values (123,
'Stanford', 'EE', 'N'); insert into Apply values (123,
'Berkeley', 'CS', 'Y'); insert into Apply values (123, 'Cornell',
'EE', 'Y');
insert into Apply values (234, 'Berkeley', 'biology', 'N'); insert into
Apply values (345, 'MIT', 'bioengineering', 'Y'); insert into Apply values
(345, 'Cornell', 'bioengineering', 'N'); insert into Apply values (345,
'Cornell', 'CS', 'Y');
insert into Apply values (345, 'Cornell', 'EE', 'N'); insert into
Apply values (678, 'Stanford', 'history', 'Y'); insert into Apply
values (987, 'Stanford', 'CS', 'Y'); insert into Apply values (987,
'Berkeley', 'CS', 'Y'); insert into Apply values (876, 'Stanford',
'CS', 'N'); insert into Apply values (876, 'MIT', 'biology', 'Y');
insert into Apply values (876, 'MIT', 'marine biology', 'N'); insert into
Apply values (765, 'Stanford', 'history', 'Y'); insert into Apply values
(765, 'Cornell', 'history', 'N'); insert into Apply values (765, 'Cornell',
'psychology', 'Y'); insert into Apply values (543, 'MIT', 'CS', 'N');
commit;
select * from Student;
select * from Apply;
select * from College;
select count(*) as student_count from Student;

select avg(GPA) as average_gpa from student ;

select max(GPA) as max_GPA ,min(GPA) as min_GPA from student;

select count(*) as student_with_gpa from student where GPA >=3.7; 

select max(GPA) as max_gpa , avg(GPA) as avg_gpa , min(GPA) as min_gpa , sum(GPA) as total_gpa from student ;

select count(*) as total_college from College;

select count(Distinct major) as diff_major from Apply;

select count(*) as applications from Apply;

select sum(Distinct GPA) as distinct_gpa from STUDENT;

select count(*) as application_accepted from Apply where decision ='Y';

select count(*) as student_with_gpa from Student where GPA >3.4 and sizeHS>1000;

select count(*) as apply_to_marinebiology from Apply where major = 'marine biology';

SELECT DECISION, COUNT(*) FROM APPLY GROUP BY DECISION;

SELECT major,count(*) FROM APPLY GROUP BY major;

SELECT cName, count(*) from Apply Group by cName;

select major,count(*)as particular_major from Apply Group by major;

select cName,major,count() as application_greater_than_two from Apply Group by cName,major Having COUNT() >= 2;

select cName, count() from apply group by cName having count()>=2;

select state,count() from College group by state having count()>1;

select sName FROM Student group by sName having count(*)>1;

select sName,count(*) From Student group by sName;

SELECT sName FROM Student s JOIN Apply a ON s.sID = a.sID GROUP BY sName HAVING COUNT(a.sID) >= 3;

SELECT sName FROM Student s LEFT JOIN Apply a ON s.sID = a.sID WHERE a.sID IS NULL;

SELECT cName, MAX(GPA) AS max_GPA, AVG(GPA) AS avg_GPA, MIN(GPA) AS min_GPA FROM Apply a JOIN Student s ON a.sID = s.sID GROUP BY cName;

SELECT GPA, COUNT(*) AS frequency FROM Student GROUP BY GPA;

SELECT COUNT(*) AS students_ABC FROM Student WHERE sName LIKE 'A%' OR sName LIKE 'B%' OR sName LIKE 'C%';
